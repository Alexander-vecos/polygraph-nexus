# USER_JOURNEYS — пользовательские сценарии (подробно)

## 0) Заметка про стиль сценариев
Я пишу сценарии так, чтобы по ним можно было:
- делать экраны;
- делать таблицы и связи;
- писать тест‑кейсы;
- делать backlog.

---

## 1) Онбординг владельца (ты)

### Цель
За 30–60 минут довести систему до состояния «можно завести первый заказ и прогнать по маршруту».

### Поток
1. Вход/регистрация
2. Создание организации (например: “IdeaPack”)
3. Создание площадки (например: “Цех №1”)
4. Создание секторов:
   - шелкотрафарет
   - регенерация
   - подготовка трафаретов
   - супервайзер
   - сборка/упаковка
   - QC
   - отгрузка
5. Создание пользователей:
   - менеджер
   - мастер шелкографии
   - мастер сборки
6. Проверка:
   - создать тест‑заказ
   - назначить маршрут
   - создать задачи
   - пройти статусы

---

## 2) Сценарий менеджера: «Новый заказ от клиента»

### Входные данные
- клиент (существующий или новый)
- изделие: тип/материал/размер/тираж/цвета/печать
- дедлайн
- входящие файлы (макет/логотип/референс)

### Поток
1. Менеджер нажимает **Создать заказ**
2. Заполняет:
   - accounting_number (если уже есть из бухучёта)
   - title: “Пакет крафт 200х300, 1000 шт”
   - meta: тип=пакет, конструкция=майка/банан/пирожок и т.д.
3. Прикладывает файлы:
   - макет
   - превью
   - переписку/ТЗ (если есть)
4. Выбирает маршрут:
   - шаблон маршрута (Print → Cut → Assemble → QC → Ship)
   - или вручную
5. Система:
   - создаёт routing
   - создаёт routing_stages
   - создаёт задачи на исполнителей (если задано)
6. Менеджер переводит заказ в `confirmed` и ставит дедлайн
7. Уведомления:
   - исполнителям прилетает “Новая задача”
   - супервайзеру прилетает “Новый заказ в очереди”

---

## 3) Сценарий мастера: «Моя смена / мои задачи»

### Поток
1. Исполнитель открывает “Мои задачи”
2. Видит список карточек:
   - приоритет
   - дедлайн
   - к какому заказу относится
3. Берёт задачу → `in_progress`
4. По ходу:
   - пишет комментарий (что сделано/что мешает)
   - прикладывает фото/файл (например, фото брака)
5. Завершает задачу → `done`
6. Если обнаружил проблему:
   - ставит `blocked` + причина
   - или создаёт подзадачу “доделать/переделать”

---

## 4) Сценарий QC: «Контроль качества и возврат на переделку»

### Поток
1. Этап QC активируется, когда предыдущие этапы done
2. QC открывает чеклист (ручной или AI‑сгенерированный)
3. Отмечает пункты:
   - печать/цвет/смещение
   - рез/край
   - сборка
   - упаковка
4. Если ок:
   - stage.status = done
   - order.status = packed/shipped (в зависимости)
5. Если не ок:
   - stage.status = blocked
   - order.status = rework
   - создаётся задача “Переделка” на нужный сектор
   - прикладываются фото/комментарии

---

## 5) Сценарий отгрузки: «Закрытие заказа»

1. Сектор отгрузки отмечает упаковку
2. Вносит:
   - ТТН/номер отправки
   - фото коробки/упаковки (опционально)
3. order.status = shipped → closed
4. Система:
   - фиксирует финальное время
   - закрывает оставшиеся задачи
   - предлагает менеджеру оставить заметку/итог

---

## 6) Сценарий “Внешний подрядчик” (MVP‑2+)

1. Внешний подрядчик регистрируется как company/provider
2. Заполняет:
   - какие услуги делает
   - какое оборудование
   - сроки/стоимость
3. Менеджер отправляет запрос
4. Подрядчик принимает/отказывается
5. Формируется заказ‑подзаказ или “внешняя операция” в маршруте

---

## 7) Сценарий “Склад: резерв материалов” (MVP‑2+)

1. Менеджер/супервайзер выбирает материал и количество
2. Система создаёт reservation
3. Если производство стартовало:
   - резерв фиксируется (заморозка)
4. При завершении:
   - списание
5. Если отменили:
   - резерв снимается

---

## 8) Нефункциональные сценарии

### 8.1. Плохой интернет
- PWA открывается
- видны последние данные
- пользователь может:
  - просмотреть задачи
  - писать черновики сообщений
- при восстановлении связи — синхронизация

### 8.2. Масштабирование на 3 производства
- каждая организация изолирована RLS
- пользователь может состоять в нескольких org
- быстрое переключение org в UI
